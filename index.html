<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Portfolio</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible+Next:ital,wght@0,200..800;1,200..800&family=Noto+Sans+Symbols+2&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Libre+Barcode+128+Text&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Libre+Barcode+128&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=close,menu,translate" />
	<link rel="icon" href="./favicon.png" type="image/png">
	<link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">

	<style>
		@font-face {
			font-family: 'neue';
			src: url('./HelveticaNeue-BoldExt.otf') format('opentype');
			font-weight: bold;
			font-style: normal;
		}
		
		.libre-barcode-128-text-regular {
			font-family: "Libre Barcode 128 Text", system-ui;
			font-weight: 400;
			font-style: normal;
		}
		
		.libre-barcode-128-regular {
			font-family: "Libre Barcode 128", system-ui;
			font-weight: 400;
			font-style: normal;
		}
		
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}
		button {
			all: unset;
			cursor: pointer;
		}
		html {
			background-color: #000;
			font-size: clamp(0.2rem, 1.48vw, .85rem);
		}
		body {
			display: flex;
			flex-direction: column;
			justify-content: start;
			align-items: center;
		}

		.visual {position: absolute;}

		.frame {
			position: relative;
		}
		.frame > img {
			width: 100%;
		}
		.toddao {
			width: 65rem;
			height: 23.75rem;
		}

		.dummy-frame {
			opacity: 0 !important;
			pointer-events: none !important;
			visibility: hidden; 
		}
		
		.ladder.strip {
			margin-top: -23.75rem; 
		}

		.project-container {
			position: relative;
		}

		/* Vertical text overlays */
		.vertical-text-left {
			writing-mode: vertical-rl;
			position: absolute;
			top: 50%;
			left: -1.2rem;
			transform: translateY(-50%) rotate(180deg);
			z-index: 3;
			pointer-events: none;
		}

		.vertical-text-right {
			writing-mode: vertical-rl;
			position: absolute;
			top: 50%;
			right: -1.2rem;
			transform: translateY(-50%);
			z-index: 3;
			pointer-events: none;
		}

		.vertical-text-left span > span,
		.vertical-text-right span > span {
			display: inline;
		}
		.vertical-text-left span,
		.vertical-text-right span {
			text-orientation: mixed;
			font-size: 4rem;
			color: black;
			white-space: nowrap;
			letter-spacing: 0.1rem;
			display: block;
		}

		.frame button {
			position: absolute;
			transform: translate(-50%, -50%);
			top: 50%;
			left: 50%;
		}
		
		.toddao button {
			will-change: height, transform; 
			width: 52.6rem;
			height: 23rem;
			transition: height 1s ease, transform 1s ease, filter 0.3s ease;
			z-index: 1;
			border-radius: 1rem;
		}
		.toddao button.expanded {
			height: 70.5rem;
		}
		
		.toddao.move-up button {
			transform: translate3d(-50%, calc(-50% - 23.75rem), 0);
		}
		
		.toddao.move-down button {
			transform: translate3d(-50%, calc(-50% + 23.75rem), 0);
		}

		.frame button img {
			width: 100%;
			height: 100%;
			object-fit: cover;
			transition: opacity 0.5s ease;
			border-radius: 1rem;
		}
		.frame button {
			color: white;
			font-size: 8rem;
		}
		.frame button:hover {
			filter: brightness(1.1); 
			box-shadow: 
				0 0 0.5rem rgba(0,0,0,1),
				0 0 0.5rem rgba(0,0,0,1),
				0 0 0 0.1rem rgba(255,0,0,0.9);
		}

		/* YouTube Player Styles */
		.youtube-container {
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			width: min(90%, 50rem);
			aspect-ratio: 16/9;
			opacity: 0;
			visibility: hidden;
			transition: opacity 0.5s ease, visibility 0.5s ease;
			z-index: 5000;
			pointer-events: none;
		}
		
		.youtube-container.show {
			opacity: 1;
			visibility: visible;
			pointer-events: auto;
		}
		
		.youtube-container iframe {
			width: 100%;
			height: 100%;
			border-radius: 1rem;
			border: none;
			box-shadow: 0 0 2rem rgba(0, 0, 0, 0.8);
			position: absolute; 
			z-index: 2; 
			opacity: 0; 
			transition: opacity 0.5s ease; 
		}

		.youtube-placeholder {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: #333; 
			border-radius: 1rem;
			display: flex;
			justify-content: center;
			align-items: center;
			color: white;
			font-size: 4rem; 
			font-family: "neue", sans-serif;
			text-align: center;
			z-index: 1; 
		}

		/* Description Container and Button Styles */
		.text-and-button-container {
			position: absolute;
			top: 25rem; 
			left: 50%;
			transform: translateX(-50%);
			width: min(90%, 50rem);
			opacity: 0;
			visibility: hidden;
			transition: opacity 0.5s ease, visibility 0.5s ease;
			z-index: 11;
			pointer-events: none;
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 1.5rem;
		}

		.text-and-button-container.show {
			opacity: 1;
			visibility: visible;
			pointer-events: auto;
		}

		.project-description {
			width: 100%;
			background: rgba(0, 0, 0, 0.9);
			backdrop-filter: blur(1rem);
			-webkit-backdrop-filter: blur(1rem);
			color: white;
			padding: 1.5rem;
			border-radius: 1rem;
			font-size: 2rem;
			line-height: 1.4;
			font-family: "Atkinson Hyperlegible Next", sans-serif;
			text-align: left;
		}
		
		.crew-button {
			width: 20% !important;
			height: 4rem !important;
			margin-top: 12rem;
			background: rgba(50, 50, 50, 0.8);
			backdrop-filter: blur(0.5rem);
			-webkit-backdrop-filter: blur(0.5rem);
			padding: 0 0 !important;
			font-family: "neue", sans-serif;
			font-weight: bold;
			border-radius: 1rem;
			line-height: 0 !important;
			box-shadow: 
				inset 0 0.1rem 0 rgba(255, 255, 255, 0.3),
				0 0.2rem 0.5rem rgba(0, 0, 0, 0.1);
			text-shadow: 0 0 0.8rem rgba(255, 255, 255, 0.6);
			color: #000;
			font-size: 2rem !important;
			display: flex;
			justify-content: center;
			align-items: center;
			transition: all 0.2s ease;
			border: 0.05rem solid rgba(255, 255, 255, 0.2);
		}

		.crew-button:hover {
			background: rgba(255, 255, 255, 0.35);
			box-shadow: 
				inset 0 0.1rem 0 rgba(255, 255, 255, 0.4),
				0 0.3rem 0.8rem rgba(0, 0, 0, 0.15);
			text-shadow: 0 0 1.2rem rgba(255, 255, 255, 0.8);
			color: black;
		}

		/* Navigation Header */
		header {
			position: fixed;
			top: 0;
			left: 50%;
			transform: translateX(-50%);
			width: 57.5rem;
			height: 10rem;
			z-index: 10001;
			display: flex;
			align-items: center;
			gap: 1rem;
			padding: 1rem;
			pointer-events: none;
		}

		nav {
			flex: 1;
			background: rgba(240, 248, 255, 0.12);
			backdrop-filter: blur(1.5rem) saturate(1.3);
			-webkit-backdrop-filter: blur(1.5rem) saturate(1.3);
			border-radius: 1rem;
			box-shadow: 
				inset 0 0.1rem 0 rgba(255, 255, 255, 0.2),
				0 0.3rem 1rem rgba(0, 0, 0, 0.1);
			border: 0.05rem solid rgba(255, 255, 255, 0.15);
			padding: 1rem;
			opacity: 1;
			pointer-events: none;
			transition: opacity 0.2s linear, pointer-events 0.2s linear;
		}

		nav.hide {
			opacity: 0;
			pointer-events: none;
		}
		
		nav.show {
			opacity: 1;
			pointer-events: auto;
		}
		
		nav ul {
			display: grid;
			grid-template-columns: 1fr 1fr 9rem;
			align-items: center;
			list-style: none;
			gap: 1rem;
			margin: 0;
			padding: 0;
			height: 100%;
		}
		
		nav button {
			background: rgba(255, 255, 255, 0.25);
			backdrop-filter: blur(0.5rem);
			-webkit-backdrop-filter: blur(0.5rem);
			padding: 1rem 0;
			font-family: "neue", sans-serif;
			font-weight: bold;
			border-radius: 1rem;
			line-height: 1;
			box-shadow: 
				inset 0 0.1rem 0 rgba(255, 255, 255, 0.3),
				0 0.2rem 0.5rem rgba(0, 0, 0, 0.1);
			text-shadow: 0 0 0.8rem rgba(255, 255, 255, 0.6);
			color: #000;
			font-size: 2.6rem;
			display: flex;
			justify-content: center;
			align-items: center;
			gap: 1rem;
			width: 100%;
			transition: all 0.2s ease;
			border: 0.05rem solid rgba(255, 255, 255, 0.2);
		}
		
		nav button:hover {
			background: rgba(255, 255, 255, 0.35);
			box-shadow: 
				inset 0 0.1rem 0 rgba(255, 255, 255, 0.4),
				0 0.3rem 0.8rem rgba(0, 0, 0, 0.15);
			text-shadow: 0 0 1.2rem rgba(255, 255, 255, 0.8);
		}

		.burger-button {
			flex-shrink: 0;
			width: 6rem;
			height: 6rem;
			background: rgba(200, 210, 220, 0.3);
			backdrop-filter: blur(1.5rem) saturate(1.2);
			-webkit-backdrop-filter: blur(1.5rem) saturate(1.2);
			border-radius: 1rem;
			font-family: "neue", sans-serif;
			font-weight: bold;
			box-shadow: 
				inset 0 0.1rem 0 rgba(255, 255, 255, 0.2),
				0 0.3rem 1rem rgba(0, 0, 0, 0.12);
			text-shadow: 0 0 0.8rem rgba(255, 255, 255, 0.7);
			color: #000;
			font-size: 2.6rem;
			display: flex;
			justify-content: center;
			align-items: center;
			transition: all 0.2s ease;
			border: 0.1rem solid rgba(255, 255, 255, 0.8);
			pointer-events: visible;
		}
		
		.burger-button:hover {
			background: rgba(220, 230, 240, 0.4);
			box-shadow: 
				inset 0 0.1rem 0 rgba(255, 255, 255, 0.3),
				0 0.4rem 1.2rem rgba(0, 0, 0, 0.15);
			text-shadow: 0 0 1.2rem rgba(255, 255, 255, 0.9);
		}

		.frame button span {
			position: absolute;
			bottom: 0;
			font-size: 2.5rem;
			color: white;
			background: rgba(0, 0, 0, .2);
			backdrop-filter: blur(0.3rem);
			-webkit-backdrop-filter: blur(0.3rem);
			z-index: 2;
			padding: 1rem;
			font-family: neue;
			line-height: 1;
			border-radius: 1rem;
		}
		.left {right:0;}
		.right {left:0}

		.material-symbols-outlined {
			font-variation-settings:'FILL' 0,'wght' 700,'GRAD' 0,'opsz' 48;
			font-size: 2.6rem;
			line-height: 1;
		}

		/* Hero Popup Styles */
		.hero-popup {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(0, 0, 0, 0.8);
			backdrop-filter: blur(1rem);
			-webkit-backdrop-filter: blur(1rem);
			z-index: 20000;
			display: flex;
			justify-content: center;
			align-items: center;
			opacity: 0;
			visibility: hidden;
			transition: opacity 0.3s ease, visibility 0.3s ease;
		}

		.hero-popup.show {
			opacity: 1;
			visibility: visible;
		}

		.hero-content {
			background: rgba(255, 255, 255, 0.1);
			backdrop-filter: blur(2rem) saturate(1.5);
			-webkit-backdrop-filter: blur(2rem) saturate(1.5);
			border: 0.1rem solid rgba(255, 255, 255, 0.2);
			border-radius: 2rem;
			box-shadow: 
				0 0 4rem rgba(0, 0, 0, 0.5),
				inset 0 0 2rem rgba(255, 255, 255, 0.1);
			width: min(90%, 80rem);
			max-height: 90vh;
			overflow-y: auto;
			position: relative;
			display: flex;
			flex-direction: column;
		}

		.hero-close {
			position: absolute;
			top: 2rem;
			right: 2rem;
			width: 6rem;
			height: 6rem;
			background: rgba(255, 0, 0, 0.6);
			backdrop-filter: blur(0.5rem);
			-webkit-backdrop-filter: blur(0.5rem);
			border-radius: 50%;
			display: flex;
			justify-content: center;
			align-items: center;
			z-index: 10;
			transition: all 0.2s ease;
			border: 0.1rem solid rgba(255, 255, 255, 0.3);
		}

		.hero-close:hover {
			background: rgba(255, 0, 0, 1);
			transform: scale(1.1);
		}

		.hero-close .material-symbols-outlined {
			color: white;
			font-size: 3rem;
		}

		.hero-image {
			width: 100%;
			height: auto;
			object-fit: cover;
			border-radius: 2rem 2rem 0 0;
		}

		.hero-text {
			padding: 4rem;
			color: white;
			font-family: "Atkinson Hyperlegible Next", sans-serif;
		}

		.hero-text h1 {
			font-family: "neue", sans-serif;
			font-size: 4rem;
			margin-bottom: 2rem;
			text-shadow: 0 0 2rem rgba(255, 255, 255, 0.3);
		}
		
		/* Heading Style (h2s are now removed, but keeping the style block for structure consistency) */
		.hero-text h2 {
			font-family: "neue", sans-serif;
			font-size: 3rem;
			margin-top: 3rem;
			margin-bottom: 1rem;
			color: white;
		}

		.hero-text p {
			font-size: 3rem;
			line-height: 1.6;
			text-shadow: 0 0 1rem rgba(0, 0, 0, 0.5);
			white-space: pre-line;
		}

		/* MODIFIED: Crew Grid Styles - One Liner */
		.crew-list {
			display: grid;
			grid-template-columns: 1fr; /* Full width rows */
			gap: 1rem;
			width: 100%;
			margin-top: 2rem;
		}
		
		/* Divider between Actors and Crew */
		.crew-list.actors-section {
			/* Reduced margin-top since h2 is gone, added bottom padding and border to separate */
			margin-top: 0;
			margin-bottom: 3rem;
			padding-bottom: 2rem;
			border-bottom: 0.1rem dashed rgba(255, 255, 255, 0.2);
		}

		.crew-card {
			background: rgba(255, 255, 255, 0.08);
			border: 0.1rem solid rgba(255, 255, 255, 0.1);
			padding: 1.5rem;
			border-radius: 1rem;
			display: flex; /* CHANGED to Row */
			flex-direction: row;
			align-items: center; /* Vertically center items */
			gap: 1rem;
			flex-wrap: wrap; /* Allow wrapping on mobile */
			transition: background 0.2s ease;
		}

		.crew-card:hover {
			background: rgba(255, 255, 255, 0.12);
		}
		
		/* Actors/Stars Card Style (Yellow) */
		.crew-card.actor-card {
			background: rgba(255, 255, 0, 0.15); /* Light yellow/gold tint */
			border: 0.1rem solid rgba(255, 255, 0, 0.3);
		}

		.crew-card.actor-card:hover {
			background: rgba(255, 255, 0, 0.25);
		}

		.crew-name {
			font-family: "neue", sans-serif;
			font-size: 1.8rem;
			color: white;
			text-transform: uppercase;
			white-space: nowrap; /* Keep name on one line */
		}

		.crew-role {
			font-family: "Atkinson Hyperlegible Next", sans-serif;
			font-size: 1.6rem;
			color: rgba(255, 255, 255, 0.7);
			flex-grow: 1; /* Takes available space */
		}

		.crew-link {
			font-family: "Atkinson Hyperlegible Next", sans-serif;
			font-size: 1.4rem;
			color: #8cc9ff; /* MODIFIED: Colored link */
			text-decoration: none;
			opacity: 1;
			display: flex;
			align-items: center;
			gap: 0.5rem;
			font-weight: bold;
			margin-left: auto; /* Pushes link to the right if desired, or remove to keep tight */
		}

		.crew-link:hover {
			text-decoration: underline;
			filter: brightness(1.2);
		}

		/* Scrollbar styling for popup */
		.hero-content::-webkit-scrollbar {
			width: 0.8rem;
		}

		.hero-content::-webkit-scrollbar-track {
			background: rgba(255, 255, 255, 0.1);
			border-radius: 0.4rem;
		}

		.hero-content::-webkit-scrollbar-thumb {
			background: rgba(255, 255, 255, 0.3);
			border-radius: 0.4rem;
		}

		.hero-content::-webkit-scrollbar-thumb:hover {
			background: rgba(255, 255, 255, 0.4);
		}
	</style>
</head>
<body>

	<header>
		<nav id="mainNav" class="show">
			<ul>
				<li><button onclick="openPopup('about')">About</button></li>
				<li><button onclick="openPopup('contact')">Contact</button></li>
				<li>
					<button>
						<span class="material-symbols-outlined">translate</span>
						<span style="font-size: 1.5rem;">(EN)</span>
					</button>
				</li>
			</ul>
		</nav>

		<button class="burger-button" id="burger" aria-expanded="false" aria-controls="mainNav" onclick="burgerClicked()">
			<span class="material-symbols-outlined">menu</span>
		</button>
	</header>

	<div class="hero-popup" id="aboutPopup">
		<div class="hero-content">
			<button class="hero-close" onclick="closePopup('about')">
				<span class="material-symbols-outlined">close</span>
			</button>
			<img class="hero-image" id="aboutImage" src="./media/group.jpg" alt="About">
			<div class="hero-text">
				<h1 id="aboutTitle">About</h1>
				<p id="aboutText">Welcome to my creative portfolio. I'm a designer and developer passionate about creating innovative digital experiences.</p>
			</div>
		</div>
	</div>

	<div class="hero-popup" id="contactPopup">
		<div class="hero-content">
			<button class="hero-close" onclick="closePopup('contact')">
				<span class="material-symbols-outlined">close</span>
			</button>
			<img class="hero-image" id="contactImage" src="./media/nodes.png" alt="Contact">
			<div class="hero-text">
				<h1 id="contactTitle">Contact</h1>
				<p id="contactText">Let's collaborate! Reach out to discuss your next project or just say hello.</p>
			</div>
		</div>
	</div>

	<div class="visual strip">
		<div class="toddao frame"><img src="toddao.svg"></div>
		<div class="toddao frame"><img src="toddao.svg"></div>
		<div class="toddao frame"><img src="toddao.svg"></div>
		<div class="toddao frame"><img src="toddao.svg"></div>
		<div class="toddao frame"><img src="toddao.svg"></div>
		<div class="toddao frame"><img src="toddao.svg"></div>
		<div class="toddao frame"><img src="toddao.svg"></div>
		<div class="toddao frame"><img src="toddao.svg"></div>
		<div class="toddao frame"><img src="toddao.svg"></div>
		<div class="toddao frame"><img src="toddao.svg"></div>
		<div class="toddao frame"><img src="toddao.svg"></div>
		<div class="toddao frame"><img src="toddao.svg"></div>
		<div class="toddao frame"><img src="toddao.svg"></div>
		<div class="toddao frame"><img src="toddao.svg"></div>
		<div class="toddao frame"><img src="toddao.svg"></div>
		<div class="toddao frame"><img src="toddao.svg"></div>
	</div>

	<div class="ladder strip">
		<div class="toddao frame"></div>
		
		<div class="toddao frame dummy-frame project-container">
			<button class="expanded" style="height: 70.5rem;"></button>
			<div class="youtube-container"></div>
			<div class="text-and-button-container">
				<div class="project-description"></div>
				<button class="crew-button">Crew</button>
			</div>
		</div>

		<div class="toddao frame"></div>
	</div>

	<script>
	// Load project data
	let projectsData = null;

	// Text variables
	const leftTextWord = "bar";
	const rightTextWord = "nim";

	// Image variables (replace with your actual images)
	const aboutImageSrc = "./media/group.jpg";
	const contactImageSrc = "./media/nodes.png";

	// NEW: Translations for the loading text
	const loadingTranslations = {
		"en": "LOADING VIDEO...",
		"pt-pt": "A CARREGAR VÍDEO...",
		"zh": "加载视频...",
		"de": "VIDEO WIRD GELADEN...",
		"ar": "جار التحميل..."
	};

	// Popup content translations
	const popupContent = {
		about: {
			en: {
				title: "About",
				text: "Brazilian living in Lisbon, Portugal. Passionate about filmmaking, photography, optics, architecture, and engineering.\nFormer student at ETIC Lisboa.\nFluent in English and Portuguese."
			},
			"pt-pt": {
				title: "Sobre",
				text: "Brasileiro a viver em Lisboa, Portugal. Apaixonado por cinema, fotografia, ótica, arquitetura e engenharia.\nEx-aluno da ETIC Lisboa.\nFluente em inglês e português."
			},
			zh: {
				title: "关于",
				text: "巴西人，现居葡萄牙里斯本。热爱电影制作、摄影、光学、建筑和工程。\nETIC-Lisboa前学生。\n精通英语和葡萄牙语。"
			},
			de: {
				title: "Über",
				text: "Brasilianer mit Wohnsitz in Lissabon, Portugal. Leidenschaftlich für Filmemachen, Fotografie, Optik, Architektur und Ingenieurwesen.\nEhemaliger Student der ETIC Lisboa.\nFließend in Englisch und Portugiesisch."
			},
			ar: {
				title: "حول",
				text: "برازيلي يعيش في لشبونة، البرتغال. شغوف بصناعة الأفلام والتصوير الفوتوغرافي والبصريات والهندسة المعمارية والهندسة.\nطالب سابق في ETIC-Lisboa.\nيتحدث الإنجليزية والبرتغالية بطلاقة."
			}
		},
		contact: {
			en: {
				title: "Contact",
				text: "Looking to collaborate or share ideas? Drop me a message- I'd love to connect.\n\nig: @val.nevs\nvaldir.nvs@outlook.com\n+351 930 946 697"
			},
			"pt-pt": {
				title: "Contacto",
				text: "Procura colaborar ou partilhar ideias? Envie-me uma mensagem - adoraria conectar.\n\nig: @val.nevs\nvaldir.nvs@outlook.com\n+351 930 946 697"
			},
			zh: {
				title: "联系",
				text: "想要合作或分享想法？给我留言吧 - 我很乐意与您联系。\n\nig: @val.nevs\nvaldir.nvs@outlook.com\n+351 930 946 697"
			},
			de: {
				title: "Kontakt",
				text: "Möchten Sie zusammenarbeiten oder Ideen austauschen? Schreiben Sie mir - ich würde mich freuen, von Ihnen zu hören.\n\nig: @val.nevs\nvaldir.nvs@outlook.com\n+351 930 946 697"
			},
			ar: {
				title: "اتصال",
				text: "تبحث عن التعاون أو مشاركة الأفكار؟ أرسل لي رسالة - سأكون سعيداً بالتواصل معك.  \n\nig: @val.nevs\nvaldir.nvs@outlook.com\n+351 930 946 697"
			}
		},
		crew: { 
			en: { 
				title: "Crew & Credits",
				actors_heading: "Actors & Stars"
			},
			"pt-pt": { 
				title: "Equipa e Créditos",
				actors_heading: "Atores e Elenco"
			},
			zh: { 
				title: "团队和制作人员", 
				actors_heading: "演员和明星"
			},
			de: { 
				title: "Crew & Credits", 
				actors_heading: "Schauspieler & Stars"
			},
			ar: { 
				title: "طاقم العمل والاعتمادات",
				actors_heading: "الممثلون والنجوم"
			}
		}
	};
	
	// Crew Popup Translation for the button
	const crewButtonTranslations = {
		"en": "Crew",
		"pt-pt": "Equipa",
		"zh": "团队",
		"de": "Crew",
		"ar": "طاقم العمل"
	};

	// Navigation translations
	const navTranslations = {
		"about": {
			"en": "About",
			"pt-pt": "Sobre",
			"zh": "关于",
			"de": "Über",
			"ar": "حول"
		},
		"contact": {
			"en": "Contact",
			"pt-pt": "Contacto",
			"zh": "联系",
			"de": "Kontakt",
			"ar": "اتصال"
		}
	};

	// Language cycling
	const languages = ['en', 'pt-pt', 'zh', 'de', 'ar'];
	const languageNames = {
		'en': 'EN',
		'pt-pt': 'PT',
		'zh': '中',
		'de': 'DE',
		'ar': 'ع'
	};
	let currentLanguage = 0;

	// Track active project for crew popup updates
	let activeCrewProjectIndex = null;

	// Set images on load
	document.getElementById('aboutImage').src = aboutImageSrc;
	document.getElementById('contactImage').src = contactImageSrc;
	
	// Create Crew Popup (Structure Modified for Grid)
	const crewPopup = document.createElement('div');
	crewPopup.className = 'hero-popup';
	crewPopup.id = 'crewPopup';
	crewPopup.innerHTML = `
		<div class="hero-content">
			<button class="hero-close" onclick="closePopup('crew')">
				<span class="material-symbols-outlined">close</span>
			</button>
			<div class="hero-text">
				<h1 id="crewTitle">${popupContent.crew.en.title}</h1>
				</div>
		</div>
	`;
	document.body.appendChild(crewPopup);
	
	// Close crew popup on background click
	document.getElementById('crewPopup').addEventListener('click', (e) => {
		if (e.target === e.currentTarget) {
			closePopup('crew');
		}
	});

	// Function to generate HTML for a list of people (Actors or Crew)
	function generatePeopleHTML(peopleRaw, rolesRaw, cardClass = '') {
		if (!peopleRaw || !rolesRaw) {
			return '';
		}

		const people = peopleRaw.split(';;').map(s => s.trim()).filter(s => s.length > 0);
		
		// Map roles by ID for easy lookup
		const rolesMap = {};
		rolesRaw.split(';;').map(s => s.trim()).filter(s => s.length > 0)
			.forEach(roleString => {
				// Extract ID [x] and Role text
				const match = roleString.match(/\[(\d+)\]\s*(.*)/);
				if (match) {
					rolesMap[match[1]] = match[2].trim();
				}
			});

		let html = '';

		people.forEach(personString => {
			// Parsing Format: [1] **Name** [LinkText](LinkURL)
			const regex = /\[(\d+)\]\s*\*\*(.*?)\*\*\s*\[(.*?)\]\((.*?)\)/;
			const match = personString.match(regex);

			if (match) {
				const id = match[1];
				const name = match[2];
				const linkText = match[3];
				const linkUrl = match[4];
				const role = rolesMap[id] || "";

				html += `
					<div class="crew-card ${cardClass}">
						<div class="crew-name">${name}</div>
						<div class="crew-role">${role}</div>
						<a href="${linkUrl}" target="_blank" class="crew-link">
							${linkText} <span class="material-symbols-outlined" style="font-size:1.4rem"></span>
						</a>
					</div>
				`;
			}
		});

		return html;
	}
	
	// Main function to generate the full popup content
	function generateCrewPopupContent(project, lang) {
		const actorsPeople = project.description.stars_people;
		const actorsRoles = project.description.stars_roles ? project.description.stars_roles[lang] : null;
		const crewPeople = project.description.crew_people;
		const crewRoles = project.description.crew_roles ? project.description.crew_roles[lang] : null;
		
		let html = '';
		
		const actorsHTML = generatePeopleHTML(actorsPeople, actorsRoles, 'actor-card');
		const crewHTML = generatePeopleHTML(crewPeople, crewRoles, '');

		// 1. Actors Section (Yellow Cards)
		if (actorsHTML) {
			html += `
				<div id="actorsList" class="crew-list actors-section">
					${actorsHTML}
				</div>
			`;
		}

		// 2. Crew Section (Standard Cards)
		if (crewHTML) {
			// If actors were present, the crew list will start immediately after the divider
			// If no actors, this list will be the first content below the H1
			html += `
				<div id="crewList" class="crew-list">
					${crewHTML}
				</div>
			`;
		} else if (!actorsHTML) {
			// Only show fallback message if BOTH sections are empty
			html += '<p style="color:white; font-size:2rem; margin-top:2rem;">No crew or cast information available for this project.</p>';
		}

		return html;
	}
	// END OF REFACTOR: generateCrewPopupContent

	// Popup functions
	function openPopup(type, projectIndex = null) {
		const popup = document.getElementById(type + 'Popup');
		
		if (type === 'crew' && projectIndex !== null) {
			activeCrewProjectIndex = projectIndex;
			const project = projectsData.projects[projectIndex];
			const lang = languages[currentLanguage];
			
			// Inject all HTML content generated by the new function
			document.querySelector('#crewPopup .hero-text').innerHTML = `
				<button class="hero-close" onclick="closePopup('crew')">
					<span class="material-symbols-outlined">close</span>
				</button>
				<h1 id="crewTitle">${popupContent.crew[lang].title}</h1>
				${generateCrewPopupContent(project, lang)}
			`;
		}

		popup.classList.add('show');
		document.body.style.overflow = 'hidden';
	}

	function closePopup(type) {
		const popup = document.getElementById(type + 'Popup');
		popup.classList.remove('show');
		document.body.style.overflow = '';
		if (type === 'crew') {
			activeCrewProjectIndex = null;
		}
	}

	// Close popup on background click
	document.getElementById('aboutPopup').addEventListener('click', (e) => {
		if (e.target === e.currentTarget) {
			closePopup('about');
		}
	});

	document.getElementById('contactPopup').addEventListener('click', (e) => {
		if (e.target === e.currentTarget) {
			closePopup('contact');
		}
	});

	// Close popup on Escape key
	document.addEventListener('keydown', (e) => {
		if (e.key === 'Escape') {
			document.querySelectorAll('.hero-popup.show').forEach(popup => {
				const type = popup.id.replace('Popup', '');
				closePopup(type);
			});
		}
	});

	async function loadProjectData() {
		try {
			const response = await fetch('./data.json');
			projectsData = await response.json();
			generateProjects();
			updateLanguage();
			return Promise.resolve();
		} catch (error) {
			console.error('Error loading project data:', error);
			// FIXED: Cleaned up Tabbing for projectsData
			projectsData = {
				"projects": [
					{
						"media": [
							"https://picsum.photos/800/600?random=1", 
							"https://picsum.photos/800/600?random=2"
						],
						"videoId": "KUs1Popfd8g", 
						"date": "2024/01",
						"duration": "30 MIN",
						"translations": {
							"en": ["Project One", "Camera"],
							"pt-pt": ["Projeto Um", "Câmara"],
							"zh": ["项目一", "摄影"],
							"de": ["Projekt Eins", "Kamera"],
							"ar": ["مشروع واحد", "كاميرا"]
						},
						"description": {
							"en": "This is a sample project (YouTube).",
							"pt-pt": "Este é um projeto exemplo com demonstração em vídeo (YouTube).",
							"zh": "这是一个带有视频演示的示例项目（YouTube）。",
							"de": "Dies ist ein Beispielprojekt mit Videodemonstration (YouTube).",
							"ar": "هذا مشروع عينة مع عرض فيديو (يوتيوب).",
							
							"stars_people": `
								[1] **Ryan Gosling** [IMDb](https://www.imdb.com/name/nm0331516);;
								[2] **Emma Stone** [IMDb](https://www.imdb.com/name/nm1297015)`,
							"stars_roles": {
								"en": `
									[1] Sebastian;;
									[2] Mia`,
								"pt-pt": `
									[1] Sebastião;;
									[2] Mia`,
								"zh": `
									[1] 塞巴斯蒂安;;
									[2] 米娅`,
								"de": `
									[1] Sebastian;;
									[2] Mia`,
								"ar": `
									[1] سيباستيان;;
									[2] ميا`
							},
							
							"crew_people": `
									[1] **Alice** [Portfolio](https://www.alice.com);;
									[2] **Bob** [Instagram](https://www.instagram.com/bob_ig);;
									[3] **Charlie** [Vimeo](https://vimeo.com/charlie_vid)`,
							"crew_roles": {
								"en": `
									[1] Director, Writer, Gaffer;;
									[2] Camera Operator, Grip;;
									[3] Editor, Colorist`,
								"pt-pt": `
									[1] Realizador, Escritor, Maquinista;;
									[2] Operador de Câmara, Assistente de Eléctrica;;
									[3] Editor, Colorista`,
								"zh": `
									[1] 导演, 编剧, 灯光师;;
									[2] 摄影师, 场务;;
									[3] 剪辑师, 调色师`,
								"de": `
									[1] Regisseur, Autor, Beleuchter;;
									[2] Kameramann, Grips;;
									[3] Cutter, Kolorist`,
								"ar": `
									[1] مخرج، كاتب، مساعد الإضاءة;;
									[2] مشغل الكاميرا، معدات خفيفة;;
									[3] مونتير، مصحح ألوان`
							}
						}
					},
					{
						"media": [
							"https://picsum.photos/800/600?random=3", 
							"https://picsum.photos/800/600?random=4"
						],
						"videoId": "930022904",
						"date": "2023/12",
						"duration": "10 MIN",
						"translations": {
							"en": ["Project Two", "Design"],
							"pt-pt": ["Projeto Dois", "Design"],
							"zh": ["项目二", "设计"],
							"de": ["Projekt Zwei", "Design"],
							"ar": ["مشروع اثنان", "تصميم"]
						},
						"description": {
							"en": "Another sample project showcasing design work (Vimeo).",
							"pt-pt": "Outro projeto exemplo mostrando trabalho de design (Vimeo).",
							"zh": "另一个展示设计工作的示例项目（Vimeo）。",
							"de": "Ein weiteres Beispielprojekt mit Designarbeit (Vimeo).",
							"ar": "مشروع عينة آخر يعرض أعمال التصميم (فيميو).",
							
							"stars_people": `
								[1] **Maria** [Website](https://www.maria.com);;
								[2] **Alex** [IMDb](https://www.alex.com)`,
							"stars_roles": {
								"en": `
									[1] Lead Actress;;
									[2] Supporting Role`,
								"pt-pt": `
									[1] Atriz Principal;;
									[2] Papel Secundário`,
								"zh": `
									[1] 女主角;;
									[2] 配角`,
								"de": `
									[1] Hauptdarstellerin;;
									[2] Nebenrolle`,
								"ar": `
									[1] الممثلة الرئيسية;;
									[2] دور مساعد`
							},
							
							"crew_people": `
								[1] **David** [Instagram](https://www.instagram.com/david_ig);;
								[2] **Eve** [LinkedIn](https://www.linkedin.com/in/eve)`,
							
							"crew_roles": {
								"en": `
									[1] Director, Editor;;
									[2] Producer, Runner`,
								"pt-pt": `
									[1] Realizador, Editor;;
									[2] Produtor, Assistente de Produção`,
								"zh": `
									[1] 导演, 剪辑师;;
									[2] 制片人, 跑腿`,
								"de": `
									[1] Regisseur, Cutter;;
									[2] Produzent, Runner`,
								"ar": `
									[1] مخرج، مونتير;;
									[2] منتج، مساعد إنتاج`
							}
						}
					}
				]
			};
			generateProjects();
			updateLanguage();
			return Promise.resolve();
		}
	}

	function generateProjects() {
		if (!projectsData) return;
		
		const ladderStrip = document.querySelector('.ladder.strip');
		const lastFrame = ladderStrip.children[ladderStrip.children.length - 1];
		
		while (ladderStrip.children.length > 3) {
			ladderStrip.removeChild(ladderStrip.children[2]);
		}
		
		projectsData.projects.forEach((project, index) => {
			const frame = document.createElement('div');
			frame.className = 'toddao frame project-container';
			
			const button = document.createElement('button');
			const img = document.createElement('img');
			const leftSpan = document.createElement('span');
			const rightSpan = document.createElement('span');
			
			img.src = project.media[0];
			img.dataset.projectIndex = index;
			leftSpan.className = 'left';
			rightSpan.className = 'right';
			
			button.appendChild(img);
			button.appendChild(leftSpan);
			button.appendChild(rightSpan);
			frame.appendChild(button);

			// Add hover listener to button to trigger text shuffle on the barcode text
			button.addEventListener('mouseenter', () => {
				const textElements = frame.querySelectorAll('.libre-barcode-128-text-regular');
				textElements.forEach(el => triggerTextShuffle(el));
			});
			
			const verticalTextLeft = document.createElement('div');
			verticalTextLeft.className = 'vertical-text-left';
			const textSpanLeft = document.createElement('span');
			verticalTextLeft.appendChild(textSpanLeft);
			frame.appendChild(verticalTextLeft);
			
			const verticalTextRight = document.createElement('div');
			verticalTextRight.className = 'vertical-text-right';
			const textSpanRight = document.createElement('span');
			verticalTextRight.appendChild(textSpanRight);
			frame.appendChild(verticalTextRight);
			
			const youtubeContainer = document.createElement('div');
			youtubeContainer.className = 'youtube-container';
			frame.appendChild(youtubeContainer);
			
			const textAndButtonContainer = document.createElement('div');
			textAndButtonContainer.className = 'text-and-button-container';
			
			const descriptionDiv = document.createElement('div');
			descriptionDiv.className = 'project-description';
			textAndButtonContainer.appendChild(descriptionDiv);
			
			const crewButton = document.createElement('button');
			crewButton.className = 'crew-button';
			crewButton.addEventListener('click', (e) => {
				e.stopPropagation(); 
				openPopup('crew', index);
			});
			textAndButtonContainer.appendChild(crewButton);
			
			frame.appendChild(textAndButtonContainer);
			
			ladderStrip.insertBefore(frame, lastFrame);
		});
		
		attachProjectListeners();
	}

	function toggleMediaAndDescription(frame, projectIndex, expanded) {
		if (projectIndex < 0 || projectIndex >= projectsData.projects.length) return;

		const project = projectsData.projects[projectIndex];
		const youtubeContainer = frame.querySelector('.youtube-container');
		const textAndButtonContainer = frame.querySelector('.text-and-button-container'); 
		const img = frame.querySelector('button img');

		if (expanded) {
			img.src = project.media[1] || project.media[0];

			if (project.videoId) {
				const videoId = project.videoId;
				let videoUrl = '';
				
				if (videoId.length === 9) {
					videoUrl = `https://player.vimeo.com/video/${videoId}?autoplay=0&dnt=1`;
				} 
				else if (videoId.length === 11) {
					videoUrl = `https://www.youtube.com/embed/${videoId}?autoplay=0&rel=0&modestbranding=1`;
				} else {
					console.warn(`Unsupported video ID length for: ${videoId}`);
					videoUrl = null;
				}
				
				if (videoUrl) {
					// MODIFIED: Use translated text for loading
					const lang = languages[currentLanguage];
					const loadingText = loadingTranslations[lang] || "LOADING VIDEO...";
					
					youtubeContainer.innerHTML = `<div class="youtube-placeholder">${loadingText}</div>`;
					youtubeContainer.classList.add('show');
					
					setTimeout(() => {
						const iframe = document.createElement('iframe');
						iframe.src = videoUrl;
						iframe.frameBorder = "0";
						iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share";
						iframe.allowFullscreen = true;
						iframe.onload = () => {
							iframe.style.opacity = '1'; 
						};
						youtubeContainer.appendChild(iframe);
					}, 1000);
				}
			}
			
			setTimeout(() => {
				textAndButtonContainer.classList.add('show');
			}, 100);
		} else {
			img.src = project.media[0];
			youtubeContainer.classList.remove('show');
			textAndButtonContainer.classList.remove('show');
			setTimeout(() => {
				youtubeContainer.innerHTML = '';
			}, 500);
		}
	}

	function attachProjectListeners() {
		const ladderFrames = document.querySelectorAll('.ladder .toddao');

		ladderFrames.forEach((frame, index) => {
			const button = frame.querySelector('button:not(.crew-button)');
			
			if (!button || frame.classList.contains('dummy-frame')) return;
			
			const img = button.querySelector('img');
			const projectIndex = index - 2; 
			
			if (projectIndex < 0 || projectIndex >= projectsData.projects.length) return;
			
			const project = projectsData.projects[projectIndex];

			button.addEventListener('click', () => {
				const isExpanded = button.classList.contains('expanded');

				if (isExpanded) {
					button.classList.remove('expanded');
					toggleMediaAndDescription(frame, projectIndex, false);
					frame.classList.remove('move-up', 'move-down');
					button.style.filter = '';

					ladderFrames.forEach((frm) => {
						frm.classList.remove('move-up', 'move-down');
					});
				} else {
					ladderFrames.forEach((frm) => {
						frm.classList.remove('move-up', 'move-down');
					});

					ladderFrames.forEach((frm, frmIndex) => {
						if (frm !== frame) {
							const btn = frm.querySelector('button:not(.crew-button)');
							if (btn) {
								btn.classList.remove('expanded');
								toggleMediaAndDescription(frm, frmIndex - 2, false); 
							}
						}
					});

					const expandCard = () => {
						button.style.filter = ''; 
						button.style.pointerEvents = 'auto'; 
						button.classList.add('expanded');
						toggleMediaAndDescription(frame, projectIndex, true);
						
						ladderFrames.forEach((frm, frameIndex) => {
							if (frameIndex < index) {
								frm.classList.add('move-up');
							} else if (frameIndex > index) {
								frm.classList.add('move-down');
							}
						});
					};
					
					if (project.media[1]) {
						button.style.filter = 'brightness(0.5)';
						const loadingImage = new Image();
						loadingImage.src = project.media[1];
						button.style.pointerEvents = 'none';

						loadingImage.onload = () => {
							img.src = project.media[1];
							expandCard();
						};

						loadingImage.onerror = () => {
							console.error(`Failed to load image: ${project.media[1]}. Expanding anyway.`);
							expandCard();
						};

					} else {
						expandCard();
					}
				}
			});
		});
	}

	function initializeLayoutWithDummyCard() {
		const dummyFrame = document.querySelector('.dummy-frame');
		if (!dummyFrame) return;

		const dummyButton = dummyFrame.querySelector('button:not(.crew-button)');

		if (dummyButton) {
			dummyButton.classList.remove('expanded');
			dummyFrame.classList.remove('move-up', 'move-down');
			const youtubeContainer = dummyFrame.querySelector('.youtube-container');
			const textAndButtonContainer = dummyFrame.querySelector('.text-and-button-container'); 
			if(youtubeContainer) youtubeContainer.innerHTML = '';
			if(textAndButtonContainer) textAndButtonContainer.classList.remove('show');
		}
	}


	function updateLanguage() {
		if (!projectsData) return;
		
		const lang = languages[currentLanguage];
		const langButton = document.querySelector('nav button span:last-child');
		langButton.textContent = `(${languageNames[lang]})`;

		const aboutButton = document.querySelector('nav ul li:first-child button');
		const contactButton = document.querySelector('nav ul li:nth-child(2) button');
		aboutButton.textContent = navTranslations.about[lang];
		contactButton.textContent = navTranslations.contact[lang];

		document.getElementById('aboutTitle').textContent = popupContent.about[lang].title;
		document.getElementById('aboutText').textContent = popupContent.about[lang].text;
		document.getElementById('contactTitle').textContent = popupContent.contact[lang].title;
		document.getElementById('contactText').textContent = popupContent.contact[lang].text;
		
		if (document.getElementById('crewTitle')) {
			document.getElementById('crewTitle').textContent = popupContent.crew[lang].title;
		}

		// Refresh the Crew Popup content if it is currently open and active
		if (activeCrewProjectIndex !== null) {
			const project = projectsData.projects[activeCrewProjectIndex];
			document.querySelector('#crewPopup .hero-text').innerHTML = `
				<button class="hero-close" onclick="closePopup('crew')">
					<span class="material-symbols-outlined">close</span>
				</button>
				<h1 id="crewTitle">${popupContent.crew[lang].title}</h1>
				${generateCrewPopupContent(project, lang)}
			`;
		}

		const frames = document.querySelectorAll('.ladder .toddao.project-container:not(.dummy-frame)');
		frames.forEach((frame, index) => {
			if (index < projectsData.projects.length) {
				const project = projectsData.projects[index];
				const translations = project.translations[lang];
				const descriptionText = project.description[lang];
				
				const button = frame.querySelector('button:not(.crew-button)');
				const leftSpan = button.querySelector('.left');
				const rightSpan = button.querySelector('.right');
				const descriptionDiv = frame.querySelector('.project-description');
				const crewButton = frame.querySelector('.crew-button');
				
				const verticalTextLeftSpan = frame.querySelector('.vertical-text-left span');
				const verticalTextRightSpan = frame.querySelector('.vertical-text-right span');
				
				if (leftSpan) leftSpan.textContent = translations[0];
				if (rightSpan) rightSpan.textContent = translations[1];
				if (descriptionDiv) descriptionDiv.textContent = descriptionText;
				if (crewButton) crewButton.textContent = crewButtonTranslations[lang];
				
				if (verticalTextLeftSpan) {
					verticalTextLeftSpan.innerHTML = `<span class="libre-barcode-128-regular">${leftTextWord}</span><span class="libre-barcode-128-text-regular">${project.date}</span><span class="libre-barcode-128-regular">${leftTextWord}</span>`;
				}
				
				if (verticalTextRightSpan) {
					verticalTextRightSpan.innerHTML = `<span class="libre-barcode-128-regular">${rightTextWord}</span><span class="libre-barcode-128-text-regular">${project.duration}</span><span class="libre-barcode-128-regular">${rightTextWord}</span>`;
				}
			}
		});
	}

	function cycleLanguage() {
		currentLanguage = (currentLanguage + 1) % languages.length;
		updateLanguage();
	}

	function burgerClicked() {
		const burger = document.getElementById('burger');
		const mainNav = document.getElementById('mainNav');
		const expanded = burger.getAttribute('aria-expanded') === 'true';
		burger.setAttribute('aria-expanded', !expanded);
		
		if (expanded) {
			mainNav.classList.add('hide');
			mainNav.classList.remove('show');
		} else {
			mainNav.classList.remove('hide');
			mainNav.classList.add('show');
		}
	}

	/**
	 * HELPER: Trigger text shuffle effect
	 * Shuffles characters for 0.5 seconds then restores original text
	 * FIXED: Uses data attribute to store original text to prevent overwriting with garbage if hovered quickly
	 */
	function triggerTextShuffle(element) {
		const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
		const duration = 300;
		const frameRate = 30; 
		
		// If original text is not stored yet, store it now.
		// We use dataset so it persists even if we hover again while it's shuffling.
		if (!element.dataset.originalText) {
			element.dataset.originalText = element.textContent;
		}
		
		const originalText = element.dataset.originalText;

		// If there's an existing interval running on this element, clear it
		if (element.dataset.shuffleInterval) {
			clearInterval(Number(element.dataset.shuffleInterval));
		}

		const startTime = Date.now();

		const interval = setInterval(() => {
			const elapsed = Date.now() - startTime;
			
			if (elapsed >= duration) {
				// Stop and restore
				element.textContent = originalText;
				clearInterval(interval);
				delete element.dataset.shuffleInterval;
				// Note: We keep dataset.originalText so future hovers know the true value
			} else {
				// Shuffle
				element.textContent = originalText.split('').map(char => {
					// Preserve slashes or spaces if you want, or shuffle everything
					if (char === '/' || char === ' ') return char;
					return chars[Math.floor(Math.random() * chars.length)];
				}).join('');
			}
		}, frameRate);

		element.dataset.shuffleInterval = interval;
	}

	document.addEventListener('DOMContentLoaded', () => {
		loadProjectData().then(() => {
			initializeLayoutWithDummyCard(); 
		});
	
		const translateButton = document.querySelector('nav ul li:last-child button');
		translateButton.addEventListener('click', cycleLanguage);
	
		let hasScrolled = false;
		window.addEventListener('scroll', () => {
			if (!hasScrolled && window.scrollY > 50) {
				hasScrolled = true;
				const mainNav = document.getElementById('mainNav');
				mainNav.classList.remove('show');
				mainNav.classList.add('hide');
			}
		});
	});
	</script>

</body>
</html>