<!DOCTYPE html>
<html>
<head>
<title>Simple Page</title>
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Michroma&display=swap" rel="stylesheet" />
<style>
:root {
  --pitch: calc(4.75 / 70 * 100vw);
  --box-width: calc(2.794 / 70 * 100vw);
  --box-height: calc(1.981 / 70 * 100vw);
  --box-radius: calc(0.51 / 70 * 100vw);
}
html, body {
  height: 100%;
  margin: 0;
  font-family: 'Michroma', sans-serif;
}
.container {
  display: flex; justify-content: center; align-items: center;
  min-height: 100vh; width: 100vw;
}
.film {
  display: flex; justify-content: center; align-items: stretch;
  width: calc(65 / 70 * 100vw); min-height: 100vh; background-color: orange;
}
.strip-left, .strip-right {
  margin-top: calc(-2.972 / 70 * 100vw);
  background-color: orange;
  width: calc((65 - 52.63) / 2 / 70 * 100vw);
  min-height: 100vh;
  display: flex; flex-direction: column; align-items: center;
  gap: calc(var(--pitch) - var(--box-height));
  padding-top: var(--pitch); box-sizing: border-box; overflow-y: auto;
  position: relative;
}
.year-right {
  position: relative; /* change from absolute to relative */
  height: auto;       /* remove fixed height */
  width: auto;        /* adjust width if needed */
  pointer-events: none;
  background-color: transparent;
  z-index: 9999;
}


.perf-hole {
  width: var(--box-width); height: var(--box-height);
  border-radius: var(--box-radius); background-color: white;
  flex-shrink: 0; box-shadow: 0 0 4px rgba(0,0,0,0.2);
}
.strip-left .perf-hole { transform: translateX(40%); }
.strip-right .perf-hole { transform: translateX(-40%); }

.zone {
  margin-top: calc(4.75 / 70 * 100vw);
  background-color: orange;
  width: calc(52.63 / 70 * 100vw);
  display: flex; flex-direction: column; align-items: center;
  justify-content: flex-start; min-height: 100vh; overflow-y: auto;
  position: relative;
}
.frame {
  --x-value:5;
  position: relative; background-color: transparent;
  width: 100%; aspect-ratio: calc(52.63 / (var(--x-value) * 4.75));
  flex-shrink: 0; border-radius: 12px; margin-bottom: 0;
  display: flex; flex-direction: column;
  padding: calc(0.3 / 70 * 100vw); box-sizing: border-box;
}
.frame-core {
  background-color: blue; border-radius: calc(.51 / 70 * 100vw);
  display: flex; flex-direction: column; flex: 1 1 auto;
  overflow: hidden; position: relative; z-index: 2; cursor: pointer;
  transition: filter 0.5s ease;
}
.frame-core::before {
  content: ''; position: absolute; inset: 0;
  background-color: transparent; pointer-events: none;
  border-radius: 12px; z-index: -1;
}
.orange-bg .frame-core::after {
  content: ''; position: absolute; inset: 0;
  background-color: rgba(255, 165, 0, 0.4);
  pointer-events: none; border-radius: 12px; z-index: 2;
}
.frame-content {
  position: relative; flex: 1 1 auto; overflow: hidden;
}
.frame-content img {
  position: absolute; top: 0; left: 50%; height: 100%;
  transform: translateX(-50%); object-fit: cover;
  border-top-left-radius: calc(.51 / 70 * 100vw); border-top-right-radius: calc(.51 / 70 * 100vw);
  width: auto; max-width: none; display: block; z-index: 1;
}
.caption {
  flex-shrink: 0; background-color: rgba(0,0,0,0.5); color: #fff;
  text-align: center; font-size: calc(1.8 / 70 * 100vw);
  padding: 0.3em 0; border-bottom-left-radius: calc(.51 / 70 * 100vw);
  border-bottom-right-radius: calc(.51 / 70 * 100vw); position: relative; z-index: 3;
  pointer-events: none;
}
.year-label {
  position: absolute; left: 110%;
  transform: translateX(-8%) rotate(90deg);
  transform-origin: top left;
  font-size: calc(1.8 / 70 * 100vw); font-weight: bold;
  pointer-events: none; white-space: nowrap; user-select: none;
  z-index: 10000; transition: color 0.5s ease;
  background: white; color: black;
}
.black-bg { background-color: black !important; }
.black-bg .year-label { color: yellow !important; }
.black-bg .frame-content img { filter: none !important; }
.orange-bg { background-color: orange !important; }
.orange-bg .year-label { color: black !important; }
.orange-bg .frame-content img { filter: hue-rotate(180deg) invert(1); }
.film.black-bg,
.year-right.black-bg {background-color: black !important;}
.film.orange-bg,
.year-right.orange-bg {background-color: orange !important;}

/* pop-in */
@keyframes popIn {
  from { opacity: 0; transform: scale(0.8); }
  to   { opacity: 1; transform: scale(1); }
}
/* Modal */
#info-modal {
  display: none; position: fixed; inset: 0;
  background: rgba(0,0,0,0.7);
  justify-content: center; align-items: center; z-index: 20000;
}
#info-modal .modal-content {
  background: rgba(255,255,255,0.3);   /* 30% */
  padding: 1rem; border-radius: 8px;
  width: 80vw; max-width: 600px;
  font-family: 'Michroma', sans-serif;
  animation: popIn 0.3s ease-out;
  position: relative; overflow: auto; max-height: 90vh;
}
#info-modal .modal-content h2,
#info-modal .modal-content p {
  margin: 0 0 1rem;
}
#info-modal .modal-content img {
  width: 100%; border-radius: 4px; margin-bottom: 1rem;
}
#info-modal .modal-content button {
  display: block;
  margin: 0 auto 1rem;
  padding: 0.5em 1em;
  font-family: 'Michroma', sans-serif;
  font-size: 1rem;
  cursor: pointer;
}
#info-modal .modal-content iframe {
  width: 100%; height: 315px; border: none; border-radius: 4px;
}
</style>
</head>
<body>
<div class="container">
  <div class="film">
    <div class="strip-left"></div>
    <div class="zone">
      <div class="frame" style="--x-value:5;">
        <div class="frame-core"
             data-info="Project 0"
             data-desc="Hereâ€™s a longer description of Project 0..."
             data-photo="https://picsum.photos/seed/p0/600/300"
             data-video="dQw4w9WgXcQ">
          <div class="frame-content"><img src="media/group0.png" alt="" /></div>
          <div class="caption">Project 0</div>
        </div>
      </div>
      <div class="frame" style="--x-value:5;">
        <div class="frame-core"
             data-info="Project 1"
             data-desc="Detail text for Project 1."
             data-photo="https://picsum.photos/seed/p1/600/300"
             data-video="eY52Zsg-KVI">
          <div class="frame-content"><img src="media/aaa.jpg" alt="" /></div>
          <div class="caption">Project 1</div>
        </div>
      </div>
      <!-- more frames -->
    </div>
    <div class="strip-right">
      <div class="year-right"></div>
    </div>
  </div>
</div>

<!-- Modal -->
<div id="info-modal">
  <div class="modal-content" id="modal-content"></div>
</div>

<script>
function fillStrip(strip) {
  const vw = window.innerWidth / 100;
  const pitchPx = (4.75 / 70) * 100 * vw;
  const count = Math.floor(strip.clientHeight / pitchPx);
  strip.innerHTML = '';
  for (let i = 0; i < count; i++) {
    const box = document.createElement('div');
    box.className = 'perf-hole';
    strip.appendChild(box);
  }
}

document.addEventListener('DOMContentLoaded', () => {
  // Fill strips
  document.querySelectorAll('.strip-left, .strip-right').forEach(fillStrip);

  // Year labels
  const yearRight = document.querySelector('.year-right');
  const zone = document.querySelector('.zone');
  const years = [
    "aaa '25", "Jul '25", "Jun '25", "May '25", "Jan '25",
    "Oct '24", "Oct '24", "Aug '24", "Aug '24", "Jun '24",
    "Jun '24", "Jun '24"
  ];

  function updateYear() {
    if (!yearRight) return;
    yearRight.querySelectorAll('.year-label').forEach(e => e.remove());
    zone.querySelectorAll('.frame').forEach((frame, i) => {
      const rF = frame.getBoundingClientRect();
      const rZ = zone.getBoundingClientRect();
      const top = rF.top - rZ.top + zone.scrollTop;

      const y = document.createElement('div');
      y.className = 'year-label';
      y.textContent = years[i] || 'Year';
      y.style.top = top + 'px';
      yearRight.appendChild(y);
    });
  }
  updateYear();

  // State elements
  const strips = [
    document.querySelector('.year-right'),
    document.querySelector('.film'),
    document.querySelector('.strip-left'),
    document.querySelector('.strip-right'),
    document.querySelector('.zone')
  ].filter(Boolean);

  // Sync year-right background class with film's background class
  function syncYearRightState() {
    if (!yearRight) return;
    if (yearRight.classList.contains('black-bg')) {
      yearRight.classList.add('black-bg');
      yearRight.classList.remove('orange-bg');
    } else if (yearRight.classList.contains('orange-bg')) {
      yearRight.classList.add('orange-bg');
      yearRight.classList.remove('black-bg');
    }
  }

  // Initialize all with black-bg
  strips.forEach(el => {
    el.classList.add('black-bg');
    el.classList.remove('orange-bg');
  });
  syncYearRightState();

  // Popup logic
  const modal = document.getElementById('info-modal');
  const content = document.getElementById('modal-content');

  document.querySelectorAll('.frame-core').forEach(core => {
    core.addEventListener('click', () => {
      // Switch all to orange-bg
      strips.forEach(el => {
        el.classList.add('orange-bg');
        el.classList.remove('black-bg');
      });
      syncYearRightState();

      const title = core.dataset.info || '';
      const desc = core.dataset.desc || '';
      const photo = core.dataset.photo || '';
      const vid = core.dataset.video || '';

      let html = `<h2>${title}</h2><p>${desc}</p><img src="${photo}" alt="">`;

      if (vid) {
        html += `<button id="show-video">Show Video</button><div id="video-container"></div>`;
      }

      content.innerHTML = html;

      const btn = content.querySelector('#show-video');
      if (btn) {
        btn.addEventListener('click', () => {
          const container = content.querySelector('#video-container');
          container.innerHTML = `<iframe src="https://www.youtube.com/embed/${vid}" allowfullscreen></iframe>`;
          btn.style.display = 'none';
        });
      }

      modal.style.display = 'flex';
    });
  });

  // Close modal on background click
  modal.addEventListener('click', e => {
    if (e.target === modal) {
      modal.style.display = 'none';
      // Switch back to black-bg
      strips.forEach(el => {
        el.classList.add('black-bg');
        el.classList.remove('orange-bg');
      });
      syncYearRightState();
    }
  });

  // Update strips and year labels on resize
  window.addEventListener('resize', () => {
    document.querySelectorAll('.strip-left, .strip-right').forEach(fillStrip);
    updateYear();
  });
});
</script>
</body>
</html>
